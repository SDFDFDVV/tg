case lq_load_photo:
    case lq_load_video:
    case lq_load_audio:
    case lq_load_document:
      M = tgl_message_get (TLS, &lua_ptr[p + 1].msg_id);
      if (!M || (M->media.type != tgl_message_media_photo && M->media.type != tgl_message_media_document && M->media.type != tgl_message_media_video && M->media.type != tgl_message_media_audio && M->media.type != tgl_message_media_document_encr)) {
        lua_file_cb (TLS, lua_ptr[p].ptr, 0, 0);
      } else {
        if (M->media.type == tgl_message_media_photo) {
          assert (M->media.photo);
          tgl_do_load_photo (TLS, M->media.photo, lua_file_cb, lua_ptr[p].ptr);
        } else if (M->media.type == tgl_message_media_document) {
          assert (M->media.document);
          tgl_do_load_document (TLS, M->media.document, lua_file_cb, lua_ptr[p].ptr);
		} else if (M->media.type == tgl_message_media_video) {
          assert (M->media.document);
          tgl_do_load_video (TLS, M->media.document, lua_file_cb, lua_ptr[p].ptr);
		} else if (M->media.type == tgl_message_media_audio) {
          assert (M->media.document);
          tgl_do_load_audio (TLS, M->media.document, lua_file_cb, lua_ptr[p].ptr);
        } else {
          tgl_do_load_encr_document (TLS, M->media.encr_document, lua_file_cb, lua_ptr[p].ptr);
        }
      }
      p += 2;
      break;